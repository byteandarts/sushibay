<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Order Online — Café Supreme & Sushi Bay</title>
  <meta name="description"
    content="Order from both Café Supreme and Sushi Bay in one cart. Mix and match your favorites for delivery or pickup.">
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link crossorigin href="https://fonts.gstatic.com" rel="preconnect" />
  <link
    href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;700&family=Noto+Serif:ital,wght@0,300;0,400;0,600;0,700;1,400&display=swap"
    rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="icon" type="image/png" href="/images/favicon/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/images/favicon/favicon.svg" />
  <link rel="shortcut icon" href="/images/favicon/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png" />
  <link rel="manifest" href="/images/favicon/site.webmanifest" />
  <style>
    .order-step {
      display: none;
    }

    .order-step.active {
      display: block;
    }

    .step-indicator {
      display: flex;
      justify-content: center;
      gap: 0;
      margin-bottom: 3rem;
    }

    .step-dot {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: rgba(255, 255, 255, 0.3);
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.06);
      cursor: pointer;
      transition: all 0.3s;
    }

    .step-dot:first-child {
      border-radius: 4px 0 0 4px;
    }

    .step-dot:last-child {
      border-radius: 0 4px 4px 0;
    }

    .step-dot.active {
      color: #fff;
      background: var(--sushi-primary);
      border-color: var(--sushi-primary);
    }

    .step-dot.completed {
      color: var(--sushi-gold);
      background: rgba(179, 144, 78, 0.1);
      border-color: rgba(179, 144, 78, 0.2);
    }

    .step-num {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      font-weight: 700;
    }

    .step-dot.active .step-num {
      background: rgba(255, 255, 255, 0.2);
    }

    .step-dot.completed .step-num {
      background: var(--sushi-gold);
      color: #000;
    }

    .branch-select {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 1.5rem;
      max-width: 700px;
      margin: 0 auto;
    }

    .branch-option {
      padding: 2rem;
      background: rgba(255, 255, 255, 0.03);
      border: 2px solid rgba(255, 255, 255, 0.06);
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
    }

    .branch-option:hover {
      border-color: rgba(255, 255, 255, 0.15);
    }

    .branch-option.selected {
      border-color: var(--sushi-gold);
      background: rgba(179, 144, 78, 0.05);
    }

    .branch-option h3 {
      font-family: 'Noto Serif', serif;
      font-size: 1.25rem;
      margin-bottom: 0.5rem;
    }

    .branch-option p {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.4);
    }

    .order-menu-switch {
      display: flex;
      gap: 0;
      margin-bottom: 2rem;
      justify-content: center;
    }

    .menu-switch-btn {
      padding: 0.75rem 2rem;
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: rgba(255, 255, 255, 0.5);
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.08);
      cursor: pointer;
      transition: all 0.3s;
    }

    .menu-switch-btn:first-child {
      border-radius: 4px 0 0 4px;
    }

    .menu-switch-btn:last-child {
      border-radius: 0 4px 4px 0;
    }

    .menu-switch-btn.active {
      color: #fff;
      background: var(--sushi-primary);
      border-color: var(--sushi-primary);
    }

    .menu-switch-btn.cafe-active {
      background: var(--cafe-primary);
      border-color: var(--cafe-primary);
      color: #fff;
    }

    .checkout-summary {
      max-width: 600px;
      margin: 0 auto;
      padding: 2rem;
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.06);
      border-radius: 4px;
    }

    /* Minimal order item list */
    .order-item-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.6rem 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.04);
      gap: 0.75rem;
    }

    .order-item-row:last-child {
      border-bottom: none;
    }

    .order-item-info {
      flex: 1;
      min-width: 0;
    }

    .order-item-name {
      font-size: 0.85rem;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.85);
    }

    .order-item-name-ar {
      font-size: 0.75rem;
      color: rgba(255, 255, 255, 0.35);
      margin-top: 1px;
    }

    .order-item-price {
      font-size: 0.8rem;
      color: var(--sushi-gold);
      white-space: nowrap;
      min-width: 70px;
      text-align: right;
    }

    .order-item-add {
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.7);
      border-radius: 3px;
      padding: 0.3rem 0.7rem;
      font-size: 0.7rem;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
      font-weight: 600;
      letter-spacing: 0.05em;
    }

    .order-item-add:hover {
      background: var(--sushi-primary);
      border-color: var(--sushi-primary);
      color: #fff;
    }

    .order-category-title {
      font-family: 'Noto Serif', serif;
      font-size: 0.9rem;
      color: var(--sushi-gold);
      margin: 1.25rem 0 0.5rem;
      padding-bottom: 0.4rem;
      border-bottom: 1px solid rgba(179, 144, 78, 0.15);
    }

    .order-category-title:first-child {
      margin-top: 0;
    }

    .order-menu-container {
      max-width: 700px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(255, 255, 255, 0.05);
      border-radius: 4px;
      padding: 1rem 1.5rem;
    }

    .whatsapp-btn {
      background: #25D366;
      border: none;
      color: #fff;
      padding: 0.85rem 2rem;
      border-radius: 4px;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.3s;
      letter-spacing: 0.02em;
    }

    .whatsapp-btn:hover {
      background: #1ebe57;
      transform: translateY(-1px);
    }

    .whatsapp-btn svg {
      width: 20px;
      height: 20px;
      fill: #fff;
    }
  </style>
</head>

<body>
  <div class="texture-overlay"></div>

  <!-- Navigation -->
  <nav class="site-nav nav-shared">
    <div class="nav-inner">
      <a href="index.html" class="nav-logo">
        <span class="material-symbols-outlined" style="color:var(--sushi-gold);font-size:1.75rem;">shopping_cart</span>
        <span class="nav-logo-text">Order Online</span>
      </a>
      <ul class="nav-links">
        <li><a href="cafe.html">Café Supreme</a></li>
        <li><a href="sushi.html">Sushi Bay</a></li>
        <li><a href="story.html">Our Story</a></li>
        <li><a href="locations.html">Locations</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
      <div class="nav-actions">
        <div class="lang-switcher">
          <button class="lang-btn" onclick="toggleLanguage()" title="Switch Language">
            <span class="lang-btn-text">ع</span>
          </button>
        </div>
        <button class="nav-btn nav-btn-sushi" onclick="toggleCart()" style="position:relative;">
          <span class="material-symbols-outlined" style="font-size:1rem;vertical-align:middle;">shopping_cart</span>
          Cart
          <span class="cart-badge cart-count" style="display:none;">0</span>
        </button>
        <button class="mobile-menu-btn" onclick="toggleMobileNav()">
          <span class="material-symbols-outlined">menu</span>
        </button>
      </div>
    </div>
  </nav>

  <!-- Mobile Nav -->
  <div class="mobile-nav" id="mobile-nav">
    <button class="mobile-close" onclick="toggleMobileNav()">
      <span class="material-symbols-outlined">close</span>
    </button>
    <a href="index.html">Home</a>
    <a href="cafe.html">Café Supreme</a>
    <a href="sushi.html">Sushi Bay</a>
    <a href="story.html">Our Story</a>
    <a href="locations.html">Locations</a>
    <a href="contact.html">Contact</a>
  </div>

  <!-- Order Flow -->
  <section class="section section-shared">
    <div class="container">
      <div class="story-hero-section fade-in" style="padding-bottom:1rem;">
        <span class="section-tag" style="margin-bottom:1rem;display:inline-block;"
          data-i18n="order_unified_cart">Unified Cart</span>
        <h1 class="story-hero-title font-display" style="font-size:2.5rem;" data-i18n="order_title">Order Online</h1>
        <p class="story-hero-subtitle" data-i18n="order_subtitle">
          Mix and match from both Café Supreme and Sushi Bay in a single order.
        </p>
      </div>

      <!-- Step Indicators -->
      <div class="step-indicator">
        <div class="step-dot active" id="step-dot-1" onclick="goToStep(1)">
          <span class="step-num">1</span>
          <span data-i18n="order_select_branch">Select Branch</span>
        </div>
        <div class="step-dot" id="step-dot-2" onclick="goToStep(2)">
          <span class="step-num">2</span>
          <span data-i18n="order_add_items">Add Items</span>
        </div>
        <div class="step-dot" id="step-dot-3" onclick="goToStep(3)">
          <span class="step-num">3</span>
          <span data-i18n="order_checkout">Checkout</span>
        </div>
      </div>

      <!-- Step 1: Select Branch -->
      <div class="order-step active" id="step-1">
        <h2 class="section-title font-display" style="text-align:center;margin-bottom:2rem;font-size:1.5rem;"
          data-i18n="order_choose_branch">Choose Your Branch</h2>
        <div class="branch-select">
          <div class="branch-option" onclick="selectBranch(this, 'Main Branch')">
            <span class="material-symbols-outlined"
              style="font-size:2.5rem;color:var(--sushi-gold);margin-bottom:1rem;">storefront</span>
            <h3 data-i18n="loc_main_branch">Main Branch</h3>
            <p>Café Supreme + Sushi Bay</p>
            <span class="branch-badge badge-both" style="margin-top:1rem;" data-i18n="badge_both_menus">Both
              Menus</span>
          </div>
          <div class="branch-option" onclick="selectBranch(this, 'Gezerat El Ward Club')">
            <span class="material-symbols-outlined"
              style="font-size:2.5rem;color:var(--sushi-gold);margin-bottom:1rem;">storefront</span>
            <h3 data-i18n="loc_gezerat_branch">Gezerat El Ward Club</h3>
            <p>Café Supreme + Sushi Bay</p>
            <span class="branch-badge badge-both" style="margin-top:1rem;" data-i18n="badge_both_menus">Both
              Menus</span>
          </div>
        </div>
        <div style="text-align:center;margin-top:2rem;">
          <button class="btn-primary" id="step1-next" onclick="goToStep(2)" disabled style="opacity:0.5;">
            <span data-i18n="order_continue_menu">Continue to Menu</span>
            <span class="material-symbols-outlined" style="font-size:1rem;">arrow_forward</span>
          </button>
        </div>
      </div>

      <!-- Step 2: Add Items -->
      <div class="order-step" id="step-2">
        <div class="order-menu-switch">
          <button class="menu-switch-btn active" id="switch-sushi" onclick="showOrderMenu('sushi')">
            <span class="material-symbols-outlined"
              style="font-size:1rem;vertical-align:middle;margin-right:0.5rem;">set_meal</span>
            <span data-i18n="sushi_name">Sushi Bay</span>
          </button>
          <button class="menu-switch-btn" id="switch-cafe" onclick="showOrderMenu('cafe')">
            <span class="material-symbols-outlined"
              style="font-size:1rem;vertical-align:middle;margin-right:0.5rem;">local_cafe</span>
            <span data-i18n="cafe_name">Café Supreme</span>
          </button>
        </div>

        <!-- Sushi Menu -->
        <div id="order-sushi-section" class="order-menu-container">
          <div style="text-align:center;color:rgba(255,255,255,0.3);padding:2rem 0;" data-i18n="menu_loading">Loading
            menu...</div>
        </div>

        <!-- Cafe Menu -->
        <div id="order-cafe-section" class="order-menu-container" style="display:none;">
          <div style="text-align:center;color:rgba(255,255,255,0.3);padding:2rem 0;" data-i18n="menu_loading">Loading
            menu...</div>
        </div>

        <div style="text-align:center;margin-top:3rem;display:flex;gap:1rem;justify-content:center;flex-wrap:wrap;">
          <button class="btn-outline" onclick="goToStep(1)">
            <span class="material-symbols-outlined" style="font-size:1rem;">arrow_back</span>
            <span data-i18n="order_back">Back</span>
          </button>
          <button class="btn-primary" onclick="goToStep(3)">
            <span data-i18n="order_proceed_checkout">Proceed to Checkout</span>
            <span class="material-symbols-outlined" style="font-size:1rem;">arrow_forward</span>
          </button>
        </div>
      </div>

      <!-- Step 3: Checkout -->
      <div class="order-step" id="step-3">
        <div class="checkout-summary">
          <h2 class="section-title font-display" style="text-align:center;margin-bottom:0.5rem;font-size:1.5rem;"
            data-i18n="order_summary">Order Summary</h2>
          <p style="text-align:center;color:rgba(255,255,255,0.4);font-size:0.85rem;margin-bottom:2rem;"
            id="checkout-branch">Branch: —</p>
          <div id="checkout-items"></div>
          <div
            style="border-top:1px solid rgba(255,255,255,0.08);margin-top:1.5rem;padding-top:1.5rem;display:flex;justify-content:space-between;align-items:center;">
            <span style="font-size:1rem;color:rgba(255,255,255,0.5);" data-i18n="total">Total</span>
            <span class="font-display" style="font-size:1.5rem;font-weight:700;color:var(--sushi-gold);"
              id="checkout-total">0 L.E</span>
          </div>

          <div style="margin-top:2rem;">
            <h3 class="font-display" style="font-size:1rem;margin-bottom:1rem;" data-i18n="order_delivery_details">
              Delivery Details</h3>
            <div class="form-grid" style="grid-template-columns:1fr 1fr;">
              <div class="form-group">
                <label class="form-label" data-i18n="order_name">Name</label>
                <input type="text" class="form-input" id="order-name" placeholder="Full name">
              </div>
              <div class="form-group">
                <label class="form-label" data-i18n="order_phone_required">Phone *</label>
                <input type="tel" class="form-input" id="order-phone" placeholder="+20 xxx xxx xxxx" required
                  onfocus="this.style.borderColor=''">
              </div>
              <div class="form-group full-width">
                <label class="form-label" data-i18n="order_address_required">Address *</label>
                <textarea class="form-textarea" id="order-address" style="min-height:80px;"
                  placeholder="Delivery address..." required onfocus="this.style.borderColor=''"></textarea>
              </div>
              <div class="form-group full-width">
                <label class="form-label" data-i18n="order_notes">Notes</label>
                <input type="text" class="form-input" id="order-notes" placeholder="Any special requests?">
              </div>
            </div>
          </div>

          <div style="text-align:center;margin-top:2rem;display:flex;gap:1rem;justify-content:center;flex-wrap:wrap;">
            <button class="btn-outline" onclick="goToStep(2)">
              <span class="material-symbols-outlined" style="font-size:1rem;">arrow_back</span>
              <span data-i18n="order_add_more">Add More Items</span>
            </button>
            <button class="whatsapp-btn" style="flex:1;max-width:320px;justify-content:center;"
              onclick="sendWhatsAppOrder()">
              <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z" />
              </svg>
              <span data-i18n="order_send_whatsapp">Send Order via WhatsApp</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="footer-inner">
      <div class="footer-brand">
        <span class="footer-brand-name font-display">Café Supreme</span>
        <span class="footer-sep">&</span>
        <span class="footer-brand-name font-display">Sushi Bay</span>
      </div>
      <div class="footer-links">
        <a href="cafe.html">Café</a>
        <a href="sushi.html">Sushi</a>
        <a href="locations.html">Locations</a>
        <a href="contact.html">Contact</a>
      </div>
      <div class="footer-copy">© 2026 Café Supreme & Sushi Bay.</div>
    </div>
  </footer>

  <!-- Cart Sidebar -->
  <div class="cart-overlay" id="cart-overlay" onclick="toggleCart()"></div>
  <div class="cart-sidebar" id="cart-sidebar">
    <div class="cart-header">
      <h3 class="cart-title font-display" data-i18n="your_order">Your Order</h3>
      <button class="cart-close" onclick="toggleCart()">
        <span class="material-symbols-outlined">close</span>
      </button>
    </div>
    <div class="cart-items" id="cart-items"></div>
    <div class="cart-footer">
      <div class="cart-total">
        <span class="cart-total-label">Total</span>
        <span class="cart-total-value" id="cart-total">0 L.E</span>
      </div>
      <button class="cart-checkout-btn" onclick="toggleCart(); goToStep(3);" data-i18n="proceed_checkout">
        Proceed to Checkout
      </button>
    </div>
  </div>

  <script src="js/main.js"></script>
  <script src="js/i18n.js"></script>
  <script>
    let selectedBranch = '';
    const WHATSAPP_NUMBER = '201280886177'; // +20 128 088 6177

    function selectBranch(el, name) {
      document.querySelectorAll('.branch-option').forEach(b => b.classList.remove('selected'));
      el.classList.add('selected');
      selectedBranch = name;
      const btn = document.getElementById('step1-next');
      btn.disabled = false;
      btn.style.opacity = '1';
    }

    function goToStep(n) {
      if (n === 2 && !selectedBranch) return;
      document.querySelectorAll('.order-step').forEach(s => s.classList.remove('active'));
      document.getElementById('step-' + n).classList.add('active');
      document.querySelectorAll('.step-dot').forEach((d, i) => {
        d.classList.remove('active', 'completed');
        if (i + 1 === n) d.classList.add('active');
        else if (i + 1 < n) d.classList.add('completed');
      });

      if (n === 3) updateCheckout();
      window.scrollTo({ top: 200, behavior: 'smooth' });
    }

    function showOrderMenu(type) {
      const cafe = document.getElementById('order-cafe-section');
      const sushi = document.getElementById('order-sushi-section');
      const btnCafe = document.getElementById('switch-cafe');
      const btnSushi = document.getElementById('switch-sushi');

      if (type === 'sushi') {
        sushi.style.display = '';
        cafe.style.display = 'none';
        btnSushi.classList.add('active');
        btnCafe.classList.remove('active', 'cafe-active');
      } else {
        sushi.style.display = 'none';
        cafe.style.display = '';
        btnCafe.classList.add('cafe-active');
        btnSushi.classList.remove('active');
      }
    }

    // Parse price string to number (handles "250.00 LE", "90 L.E", etc.)
    function parsePrice(priceStr) {
      return parseFloat(priceStr.replace(/[^0-9.]/g, '')) || 0;
    }

    // Load order menu (minimal list with add-to-cart buttons)
    async function loadOrderMenu(jsonFile, containerId, brand) {
      try {
        const resp = await fetch(jsonFile);
        const data = await resp.json();
        const container = document.getElementById(containerId);
        if (!container) return;

        const lang = typeof currentLang !== 'undefined' ? currentLang : 'en';
        const addLabel = lang === 'ar' ? 'أضف' : 'Add';

        let html = '';
        data.menu.forEach(cat => {
          html += `<div class="order-category-title">${cat.category}</div>`;
          cat.items.forEach(item => {
            const price = parsePrice(item.price);
            const id = (brand + '-' + item.name_en).replace(/[^a-zA-Z0-9]/g, '-').toLowerCase();
            html += `
              <div class="order-item-row">
                <div class="order-item-info">
                  <div class="order-item-name">${item.name_en}</div>
                  <div class="order-item-name-ar">${item.name_ar}</div>
                </div>
                <div class="order-item-price">${item.price}</div>
                <button class="order-item-add" onclick="Cart.add({id:'${id}',name:'${item.name_en.replace(/'/g, "\\'")}',name_ar:'${item.name_ar.replace(/'/g, "\\'")}',price:${price},brand:'${brand}'})">
                  + ${addLabel}
                </button>
              </div>`;
          });
        });
        container.innerHTML = html;
        // Re-apply translations after dynamic content load
        if (typeof applyTranslations === 'function') {
          applyTranslations(lang);
        }
      } catch (err) {
        console.error('Failed to load order menu:', err);
      }
    }

    function updateCheckout() {
      // Branch name translation
      const branchMap = {
        'Main Branch': currentLang === 'ar' ? 'الفرع الرئيسي' : 'Main Branch',
        'Gezerat El Ward Club': currentLang === 'ar' ? 'نادي جزيرة الورد' : 'Gezerat El Ward Club'
      };
      const branchDisplay = branchMap[selectedBranch] || selectedBranch || '—';
      document.getElementById('checkout-branch').textContent =
        (currentLang === 'ar' ? 'الفرع: ' : 'Branch: ') + branchDisplay;
      const items = Cart.items;
      const container = document.getElementById('checkout-items');
      if (items.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:rgba(255,255,255,0.3);padding:2rem 0;" data-i18n="order_cart_empty">' + (currentLang === 'ar' ? 'السلة فارغة. ارجع وأضف بعض العناصر!' : 'No items in cart. Go back and add some items!') + '</p>';
      } else {
        container.innerHTML = items.map(item => {
          const displayName = currentLang === 'ar' && item.name_ar ? item.name_ar : item.name;
          return `
          <div style="display:flex;justify-content:space-between;align-items:center;padding:0.75rem 0;border-bottom:1px solid rgba(255,255,255,0.05);">
            <div>
              <div style="font-size:0.9rem;">${displayName} <span style="color:rgba(255,255,255,0.3);">×${item.qty}</span></div>
              <div style="font-size:0.7rem;color:rgba(255,255,255,0.3);">${item.brand}</div>
            </div>
            <div style="display:flex;align-items:center;gap:1rem;">
              <div style="color:var(--sushi-gold);font-family:'Noto Serif',serif;">${(item.price * item.qty).toLocaleString()} L.E</div>
              <button onclick="Cart.remove('${item.id}');updateCheckout();" style="background:none;border:1px solid rgba(255,255,255,0.1);color:rgba(255,255,255,0.4);border-radius:3px;padding:0.15rem 0.4rem;font-size:0.7rem;cursor:pointer;" title="Remove">✕</button>
            </div>
          </div>
        `}).join('');
      }
      document.getElementById('checkout-total').textContent = Cart.getTotal().toLocaleString() + ' L.E';
    }

    // ===== WhatsApp Order Builder =====
    function sendWhatsAppOrder() {
      const items = Cart.items;
      if (items.length === 0) {
        alert(currentLang === 'ar' ? 'السلة فارغة! أضف بعض العناصر أولاً.' : 'Cart is empty! Add some items first.');
        return;
      }

      const name = document.getElementById('order-name')?.value?.trim() || '';
      const phone = document.getElementById('order-phone')?.value?.trim() || '';
      const address = document.getElementById('order-address')?.value?.trim() || '';
      const notes = document.getElementById('order-notes')?.value?.trim() || '';

      // Validate mandatory fields
      if (!phone) {
        const phoneInput = document.getElementById('order-phone');
        phoneInput.style.borderColor = '#e74c3c';
        phoneInput.focus();
        alert(currentLang === 'ar' ? 'يرجى إدخال رقم الهاتف' : 'Please enter your phone number');
        return;
      }
      if (!address) {
        const addressInput = document.getElementById('order-address');
        addressInput.style.borderColor = '#e74c3c';
        addressInput.focus();
        alert(currentLang === 'ar' ? 'يرجى إدخال عنوان التوصيل' : 'Please enter your delivery address');
        return;
      }

      let msg = '';

      if (currentLang === 'ar') {
        // Arabic message
        msg += '*أريد عمل طلب جديد — سوشي باي & كافيه سوبريم*\n';
        msg += '\n';
        if (selectedBranch) msg += `*الفرع:* ${selectedBranch}\n`;
        if (name) msg += `*الاسم:* ${name}\n`;
        if (phone) msg += `*الهاتف:* ${phone}\n`;
        if (address) msg += `*العنوان:* ${address}\n`;
        msg += '\n';
        msg += '*الطلب:*\n';
        msg += '\n';

        items.forEach((item, i) => {
          const itemName = item.name_ar || item.name;
          const qty = item.qty;
          const total = (item.price * qty).toLocaleString();
          // Use LTR embedding to prevent RTL reordering of numbers
          msg += `${i + 1}. ${itemName}\u200F  \u200Ex${qty}\u200E  \u200E—  ${total} جنيه\u200F\n`;
        });

        msg += '\n';
        msg += `*الإجمالي:* ${Cart.getTotal().toLocaleString()} جنيه\n`;
        if (notes) {
          msg += `\n*ملاحظات:* ${notes}\n`;
        }
      } else {
        // English message
        msg += '*Want to make a new order — Sushi Bay & Cafe Supreme*\n';
        msg += '\n';
        if (selectedBranch) msg += `*Branch:* ${selectedBranch}\n`;
        if (name) msg += `*Name:* ${name}\n`;
        if (phone) msg += `*Phone:* ${phone}\n`;
        if (address) msg += `*Address:* ${address}\n`;
        msg += '\n';
        msg += '*Order Details:*\n';
        msg += '\n';

        items.forEach((item, i) => {
          msg += `${i + 1}. ${item.name}  x${item.qty}`;
          msg += `  —  ${(item.price * item.qty).toLocaleString()} L.E\n`;
        });

        msg += '\n';
        msg += `*Total:* ${Cart.getTotal().toLocaleString()} L.E\n`;
        if (notes) {
          msg += `\n*Notes:* ${notes}\n`;
        }
      }

      const encoded = encodeURIComponent(msg);
      const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${encoded}`;
      window.open(url, '_blank');
    }

    document.addEventListener('DOMContentLoaded', () => {
      loadOrderMenu('sushi.json', 'order-sushi-section', 'Sushi Bay');
      loadOrderMenu('cafe.json', 'order-cafe-section', 'Café Supreme');
    });
  </script>
</body>

</html>